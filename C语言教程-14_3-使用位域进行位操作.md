---
title: C语言教程-14_3-使用位域进行位操作
tags: [C]
categories: C语言教程
description: 特殊的结构体-位域
---

# 引入问题

假设我们需要管理一些文件,其中除了文件的其他信息,我们还需要管理文件的权限,共有以下3种权限:

- 是否可读---r
- 是否可写---w
- 是否可执行---x

每个文件的以上3种权限都不同,现在我们需要设置一个结构体来管理文件.

一种方法是使用3个`unsigned int`类型的变量作为标志来存储这些权限信息:

```c
struct file_t {
    char * file_name;
    size_t file_size;
    ... // 其他文件信息
    unsigned int r,w,x; // 分别记录3种权限
}
```

显然是可以的,但是一个`unsigned int`类型的成员就占用4字节空间(64位平台),3个成员就占用了12个字节,而实际上我们需要的仅仅是3个bit的标志位!

C语言提供了`位域(或译位段)`来允许我们按位来定义成员并操作.

# 位域

`位域`是一种特殊的结构体,该结构体的成员是`signed int`或`unsigned int`类型变量中的一组位(bit),我们仍然使用`struct`关键字来定义一个位域,并指定每一个成员所占用的位数.

```c
struct {
    unsigned int r : 1;
    unsigned int w : 1;
    unsigned int x : 1;
}permission;
```

上述结构体位